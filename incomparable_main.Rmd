---
title: "The Incomparable"
date: "`r format(Sys.time(), '%F %R', tz = 'UTC', usetz = T)`"
author: "Lukas — @jemus42"
output: 
  html_document:
    fig_height: 8
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
source("00_setup.R")

#### Global options ####
knitr::opts_chunk$set(
  fig.path = "assets/plots/incomparable_main/"
)

incomparable_wide <- readRDS("data/incomparable_master_wide.rds") %>%
  filter(podcast == "The Incomparable")
incomparable <- readRDS("data/incomparable_master.rds") %>%
  filter(podcast == "The Incomparable")
```

## Introduction

I would like to do a lot more with this, but currently time is scarce.  
However, I want to fulfill [Jason's request](https://twitter.com/jsnell/status/800412064640483328), since I would love to be worthy of the title of *record keeper*.

I had issues with my old code to parse the podcast data, so there may be some wonkyness in the data below. Please let me know if you find something that's obviously wrong (i.e. easy for me to check/verify).

## Panelists 

### 2019 Panelists

```{r 2019_panelists, fig.height=9}
incomparable %>%
  filter(year == 2019) %>%
  group_by(person, role) %>%
  tally() %>%
  spread(role, n) %>%
  replace_na(list(guest = 0, host = 0)) %>%
  mutate(total = guest + host) %>%
  arrange(desc(total)) %>%
  datatable(
    style = "bootstrap",
    colnames = c("Person", "Guest", "Host", "Total Appearances")
  )

incomparable %>%
  filter(year == 2019) %>%
  group_by(person, role) %>%
  tally() %>%
  spread(role, n) %>%
  replace_na(list(guest = 0, host = 0)) %>%
  mutate(total = guest + host) %>%
  gather(role, n, guest, host) %>%
  {
    ggplot(data = ., aes(x = reorder(person, total), y = n, fill = role)) +
      geom_col(color = "black", alpha = .6) +
      coord_flip() +
      scale_y_continuous(breaks = seq(0, 100, 5), minor_breaks = seq(0, 100, 1)) +
      scale_fill_brewer(palette = "Set1", label = c("Guest", "Host")) +
      labs(
        title = "The Incomparable — 2019",
        subtitle = "Panelists by # of Appearances",
        x = "Panelist", y = "# of Appearances", fill = "Role"
      ) +
      theme(legend.position = "top")
  }
```

## Runtime

Because that's the easy one.

```{r runtime, fig.width=10}
incomparable_wide %>%
  mutate(title_long = str_wrap(paste0(number, ": ", title), 20)) %>%
  {
    ggplot(data = ., aes(x = date, y = duration)) +
      geom_point(alpha = .75) +
      geom_smooth(method = loess, se = F, color = "red") +
      geom_label_repel(
        data = filter(., duration > 150),
        aes(label = title_long), alpha = .8, size = 3
      ) +
      scale_x_datetime(
        date_breaks = "1 year", date_labels = "%Y",
        date_minor_breaks = "3 months"
      ) +
      scale_y_continuous(
        breaks = seq(0, 500, 30),
        minor_breaks = seq(0, 500, 10),
        limits = c(0, NA)
      ) +
      labs(
        title = "The Incomparable Network: Main Show",
        subtitle = "Episode Runtimes",
        y = "Minutes", x = "Date Published",
        caption = caption
      ) +
      theme_ipsum(grid = "y")
  }
```

Runtimes per year.

```{r runtime_year, fig.width=10}
incomparable_wide %>% {
  ggplot(data = ., aes(x = year, y = duration)) +
    geom_point(
      alpha = .75,
      position = position_jitter(height = 0, width = .2)
    ) +
    geom_boxplot(outlier.alpha = 0, alpha = .5) +
    stat_summary(fun = mean, geom = "point", color = "red") +
    scale_y_continuous(
      breaks = seq(0, 500, 30),
      minor_breaks = seq(0, 500, 10),
      limits = c(0, NA)
    ) +
    labs(
      title = "The Incomparable Network: Main Show",
      subtitle = "Episode Runtimes",
      y = "Minutes", x = "Year Published",
      caption = caption
    ) +
    theme_ipsum(grid = "y")
}
```

## Runtime per Person

```{r runtime_person, fig.height=15}
incomparable %>%
  filter(year >= 2011, podcast == "The Incomparable") %>%
  group_by(person) %>%
  mutate(mean_duration = mean(duration)) %>%
  ggplot(data = ., aes(x = reorder(person, mean_duration), y = duration)) +
  geom_point(alpha = .5, position = position_jitter(height = 0, width = .25)) +
  geom_boxplot(alpha = .5, outlier.alpha = 0) +
  coord_flip() +
  labs(
    title = "The Incomparable: Main Show",
    subtitle = "Episode Runtimes",
    y = "Duration (mins)", x = "Panelist",
    caption = caption
  )
```

